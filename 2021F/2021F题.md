# 2021F题

## 硬件选择：

### 小车1

- 校赛用小车
- STM32H743
- TB6612FNG（自购驱动板）
- 3000mah电池
- 八路红外传感器
- IMU601陀螺仪（加面包板）
- K230摄像头模块
- 红外光电对管
- HC-05蓝牙模块
- 红绿灯三色led模块

### 小车2

- 校购两轮差速小车
- STM32H743
- TB6612FNG（校购单驱动芯片）（加面包板）
- 11.1V三节快充电池
- 八路灰度蓝光传感器
- JY61P陀螺仪
- K230摄像头模块
- 红外光电对管
- HC-05蓝牙模块
- 红绿灯三色led模块

## 工程配置

### 电机、编码器：

**tim5 c1/2 PWM输出，prescaler 24-1，counter period 1000-1**

- pwma--pa0

- pwmb--pa1

**tim1/3 Encoder Mode**

ain2--pe11

ain1--pe9

bin1--pa6

bin2--pa7

**GPIO output    level:low  mode:pushpull  no pull-up/pull-down**

e1a--pc5

e1b--pb1

e2a--pc4

e2b--pb0



### 灰度传感器

 USART6  pc6--tx  pc7--rx

 KEY--PB15 gpio-input pull-up 

### 陀螺仪

USART2  pa2--tx  pa3--rx

利用tim6产生的1us定时来实现功能



### 摄像头

USART1  pa9--tx  pa10--rx



### 蓝牙模块

USART3  pb10--tx  pb11--rx



### 蜂鸣器

接了，但不用



### 红绿灯模块

PD1--GND

PD2--Red

PD3--Yellow

PD4--Green



### 红外对光灯管

3v3 GND input*1





# 主程序逻辑：

基本要求状态：

1. 放药（红外光管）
2. 直线前进(八路巡线、电机)
3. 直角前进+转弯（陀螺仪、电机、编码器）
4. 停车（八路巡线、电机、led）
5. 取药（红外光管、led）
6. 送完药掉头（陀螺仪、电机）
7. 回城（通过前面记录的转向数据来对应直角前进、转弯）

- T1：小车在放上物品一秒后（红外对光管发出信号），跟着巡线来先走直线。等到走到直角时（三岔路口），根据编码器开始从0计算运动距离，等到运动距离到20cm后，向相应方向做90度转弯（陀螺仪引导），（重复一次），待到位后停车、变色。

- T2：
- T3：

提高要求状态：

1. 
